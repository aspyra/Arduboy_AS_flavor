Version 4
SHEET 1 1624 700
WIRE 192 -256 -464 -256
WIRE -1472 -224 -1760 -224
WIRE -1216 -176 -1216 -208
WIRE -992 -176 -1216 -176
WIRE -848 -176 -992 -176
WIRE -704 -176 -704 -208
WIRE -704 -176 -752 -176
WIRE -576 -176 -704 -176
WIRE -576 -160 -576 -176
WIRE -1424 -144 -1424 -208
WIRE -1216 -144 -1216 -176
WIRE -992 -144 -992 -176
WIRE -704 -144 -704 -176
WIRE -1520 -112 -1520 -128
WIRE -48 -96 -48 -128
WIRE -704 -48 -704 -80
WIRE -576 -48 -576 -80
WIRE -1520 -32 -1520 -48
WIRE -1520 -32 -1616 -32
WIRE -1424 -32 -1424 -64
WIRE -1424 -32 -1520 -32
WIRE -1328 -32 -1424 -32
WIRE -1216 -32 -1216 -64
WIRE -1216 -32 -1264 -32
WIRE -1120 -32 -1216 -32
WIRE -992 -32 -992 -64
WIRE -992 -32 -1056 -32
WIRE -832 -32 -832 -128
WIRE -832 -32 -992 -32
WIRE -192 -32 -192 -64
WIRE -192 -32 -336 -32
WIRE -1520 -16 -1520 -32
WIRE -320 0 -336 0
WIRE -192 0 -192 -32
WIRE -320 16 -320 0
WIRE -832 32 -832 -32
WIRE -800 32 -832 32
WIRE -1520 64 -1520 48
WIRE -1216 80 -1216 -32
WIRE -1120 80 -1216 80
WIRE -1760 96 -1760 -224
WIRE -1472 96 -1472 -224
WIRE -1472 96 -1760 96
WIRE -192 96 -192 80
WIRE -192 96 -272 96
WIRE -48 96 -48 -32
WIRE -48 96 -192 96
WIRE 48 96 -48 96
WIRE -48 112 -48 96
WIRE -1008 128 -1328 128
WIRE -544 128 -864 128
WIRE -320 144 -320 112
WIRE -1216 160 -1216 80
WIRE -1136 176 -1168 176
WIRE -1088 176 -1136 176
WIRE -672 208 -704 208
WIRE -624 208 -672 208
WIRE -48 208 -48 176
WIRE -1216 256 -1216 240
WIRE -464 256 -464 -256
WIRE 192 256 192 -256
WIRE 192 256 -464 256
WIRE -1328 304 -1328 128
WIRE -1008 304 -1008 128
WIRE -1008 304 -1328 304
WIRE -1504 336 -1504 272
WIRE -752 352 -752 272
WIRE -720 352 -752 352
WIRE -864 400 -864 128
WIRE -544 400 -544 128
WIRE -544 400 -864 400
FLAG -1504 336 0
FLAG -1504 192 Vbat
FLAG -192 -144 Vcc
FLAG -320 144 0
FLAG -704 256 0
FLAG -624 288 0
FLAG -1168 224 0
FLAG -1088 256 0
FLAG -1216 256 0
FLAG -48 -128 latch_set
FLAG 48 96 latch_set
FLAG -1216 -208 Vbat
FLAG -704 -208 Vcc
FLAG -1424 -208 Vcc
FLAG -1616 -32 32u4_rst
FLAG -1056 80 latch_rst
FLAG -752 192 Vcc
FLAG -720 352 latch_set
FLAG -704 -48 0
FLAG -576 -48 0
FLAG -48 208 0
FLAG -1136 176 rst_state
FLAG -672 208 PF1_state
FLAG -1520 -128 Vcc
FLAG -1520 64 0
FLAG -800 32 latch_out
FLAG -336 0 latch_out
FLAG -336 -32 latch_rst
SYMBOL voltage -1504 176 R0
WINDOW 123 0 0 Left 0
WINDOW 39 24 124 Left 2
SYMATTR InstName V1
SYMATTR Value {V_lipo}
SYMBOL res -208 -160 R0
SYMATTR InstName R3
SYMATTR Value 100k
SYMBOL sw -752 288 R180
SYMATTR InstName S1
SYMATTR Value MYSW
SYMBOL voltage -624 192 R0
WINDOW 3 24 96 Invisible 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR Value PULSE(0 4.2 0.62 0.01m 0.01m 0.05 0.2 2)
SYMATTR InstName V2
SYMBOL sw -1216 256 R180
SYMATTR InstName S2
SYMATTR Value MYSW
SYMBOL voltage -1088 160 R0
WINDOW 3 24 96 Invisible 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR Value PULSE(0 4.2 0.4 0.01m 0.01m 0.03 0.2 4)
SYMATTR InstName V3
SYMBOL 2n7002 -272 16 M0
SYMATTR InstName U2
SYMBOL si2301cds -752 -128 M270
SYMATTR InstName U3
SYMBOL res -1008 -160 R0
SYMATTR InstName R4
SYMATTR Value 100k
SYMBOL res -1232 -160 R0
SYMATTR InstName R5
SYMATTR Value 10k
SYMBOL diode -1056 -48 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D2
SYMBOL cap -1264 -48 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C1
SYMATTR Value 100n
SYMBOL res -1440 -160 R0
SYMATTR InstName R6
SYMATTR Value 10k
SYMBOL diode -1056 64 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D3
SYMBOL cap -720 -144 R0
SYMATTR InstName C2
SYMATTR Value 20µ
SYMATTR SpiceLine Rser=0
SYMBOL cap -64 112 R0
SYMATTR InstName C3
SYMATTR Value 1µ
SYMBOL diode -1504 -48 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D4
SYMBOL diode -1504 48 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D5
SYMBOL res -592 -176 R0
SYMATTR InstName R7
SYMATTR Value 100
SYMBOL diode -64 -96 R0
SYMATTR InstName D1
SYMBOL res -208 -16 R0
SYMATTR InstName R1
SYMATTR Value 680
TEXT -456 352 Left 2 !.model MYSW SW(Ron=1m Roff=1Meg Vt=.5 Vh=-.4)
TEXT -1056 360 Left 2 !.tran 1.1 uic
TEXT -456 328 Left 2 !.include si2301cds.lib
TEXT -448 -272 Left 2 ;Power latch
TEXT -456 304 Left 2 !.include 2n7002.lib
TEXT -1320 328 Left 2 ;RESET button
TEXT -856 104 Left 2 ;32u4 PF1 pin
TEXT -456 376 Left 2 !.step param V_lipo list 3 3.6 4.2
TEXT -1752 -240 Left 2 ;32u4 body diodes
TEXT -552 -168 Left 2 ;load
TEXT -1128 24 Left 2 ;BAV70
TEXT -16 -56 Left 2 ;SM4007PL
